{"version":3,"sources":["webpack:///src/components/vueWaterMarkTools.vue","webpack:///./src/components/vueWaterMarkTools.vue?bbad","webpack:///./src/components/vueWaterMarkTools.vue","webpack:///./src/lib/index.js"],"names":["vueWaterMarkTools","name","data","mainWidth","mainHigh","layerWidth","layerHigh","smallDivWidth","smallDivHigh","smallCanvasWidth","smallCanvasHigh","deg","Math","PI","props","fatherId","String","timeOut","type","Number","default","txt","font","fontColor","opacity","angle","rowNum","colNum","waterMarkSpace","waterMarkTop","lineType","lineColorType","mounted","that","this","window","onresize","initPage","methods","_this","setTimeout","_","layerDiv","document","getElementById","parentNode","removeChild","setDomData","_this2","offsetWidth","offsetHeight","createElement","setAttribute","style","width","height","appendChild","createdDiv","i","div","createdCanvas","canvas","ctx","getContext","beginPath","rotate","closePath","canvasToImage","Image","src","toDataURL","components_vueWaterMarkTools","render","_h","$createElement","_self","_c","attrs","id","staticRenderFns","src_components_vueWaterMarkTools","__webpack_require__","normalizeComponent","lib_vueWaterMarkTools","install","Vue","component","__webpack_exports__"],"mappings":"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","file":"static/js/app.9d9f6353d5639127e81f.js","sourcesContent":["<template>\r\n    <!--\r\n              使用说明:\r\n            1.必须从父页面传过来一个fatherId,此字段为使用者想把canvas插入的div的id属性\r\n            2.props其他属性可以均为使用者自定义属性,均有默认值。\r\n            3.在父页面引入此组件之后需使用者在父页面中的mounted()钩子监并且在watch钩子中监听$route\r\n            4.在父页面使用详细:\r\n                <water-mark ref=\"waterMarkRef\" :fatherId=\"'app-main'\" :txt=\"'金融数据网关'\"></water-mark>\r\n                watch: {\r\n                    $route() {\r\n                        setTimeout(_ => {\r\n                            this.$refs.waterMarkRef.initPage();\r\n                        }, 500);\r\n                    }\r\n                },\r\n                mounted() {\r\n                    this.$refs.waterMarkRef.initPage();\r\n                }\r\n            5.如果其他页面变动频繁\r\n                this.$store.state.waterMark.waterRef.initPage();\r\n    -->\r\n    <div id=\"layerDiv\"></div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n    name: 'v-water-mark',\r\n    data() {\r\n        return {\r\n            mainWidth: 0, // 用户页面的宽度\r\n            mainHigh: 0, // 用户页面的高度\r\n            layerWidth: 0, // 组件外层的宽度\r\n            layerHigh: 0, // 组件外层的高度\r\n            smallDivWidth: 0, // 小div的宽度\r\n            smallDivHigh: 0, // 小div的高度\r\n            smallCanvasWidth: 0, // 小canvas的宽度\r\n            smallCanvasHigh: 0, // 小canvas的高度\r\n            deg: Math.PI / 180\r\n        };\r\n    },\r\n    props: {\r\n        'fatherId': String, // canvas插入的div的id属性\r\n        'timeOut': { // 水印刷新间隔（此属性是为了防止某些页面DOM操作频繁，和页面渲染时间差）\r\n            type: Number,\r\n            default: 500\r\n        },\r\n        'txt': { // 水印文本\r\n            type: String,\r\n            default: '水印文本'\r\n        },\r\n        'font': { // 字体大小及类型\r\n            type: String,\r\n            default: '16px 微软雅黑'\r\n        },\r\n        'fontColor': { // 字体颜色\r\n            type: String,\r\n            default: '#aaa'\r\n        },\r\n        'opacity': { // 水印透明度\r\n            type: Number,\r\n            default: 0.1\r\n        },\r\n        'angle': { // 水印旋转角度\r\n            type: Number,\r\n            default: 20\r\n        },\r\n        'rowNum': { // 行数\r\n            type: Number,\r\n            default: 4\r\n        },\r\n        'colNum': { // 列数\r\n            type: Number,\r\n            default: 4\r\n        },\r\n        'waterMarkSpace': {\r\n            type: Number, // 水印的margin-left的值\r\n            default: 50\r\n        },\r\n        'waterMarkTop': {\r\n            type: Number, // 水印的margin-top的值\r\n            default: 50\r\n        },\r\n        'lineType': {\r\n            type: String, //  strokeText虚线类型  fillText实线类型\r\n            default: 'fillText'\r\n        },\r\n        'lineColorType': {\r\n            type: String, //  strokeStyle虚线类型画笔  fillStyle实线类型画笔\r\n            default: ' fillStyle'\r\n        }\r\n    },\r\n    mounted() {\r\n        //  根据浏览器窗口大小，水印自动适应窗口布局\r\n        const that = this;\r\n        window.onresize = () => {\r\n            return (() => {\r\n                that.initPage();\r\n            })();\r\n        };\r\n    },\r\n    methods: {\r\n        // 初始化页面\r\n        initPage() {\r\n            setTimeout(_ => {\r\n                let layerDiv = document.getElementById('layerDiv');\r\n                //  判断是否存在最外层的div\r\n                if (layerDiv) {\r\n                    layerDiv.parentNode.removeChild(layerDiv);\r\n                    this.setDomData();\r\n                } else {\r\n                    this.setDomData();\r\n                }\r\n            }, this.timeOut);\r\n        },\r\n        // 设置一些基本的属性数据\r\n        setDomData() {\r\n            this.mainWidth = document.getElementById(this.fatherId).offsetWidth;\r\n            this.mainHigh = (_ => {\r\n                if (document.getElementById(this.fatherId).offsetHeight < 500) {\r\n                    return 500;\r\n                } else {\r\n                    return document.getElementById(this.fatherId).offsetHeight;\r\n                }\r\n            })();\r\n            this.layerWidth = this.mainWidth;\r\n            this.layerHigh = this.mainHigh;\r\n            this.smallDivWidth = this.mainWidth / this.colNum;\r\n            this.smallDivHigh = this.mainHigh / this.rowNum;\r\n            this.smallCanvasWidth = this.mainWidth / this.colNum;\r\n            this.smallCanvasHigh = this.mainHigh / this.rowNum;\r\n            let layerDiv = document.createElement('div');\r\n            layerDiv.setAttribute('id', 'layerDiv');\r\n            layerDiv.setAttribute('style', 'position:absolute;z-index:999999;top:0px;pointer-events:none;opacity: ' + this.opacity + ';overflow:hidden;');\r\n            layerDiv.style.width = this.layerWidth + 'px';\r\n            layerDiv.style.height = this.layerHigh + 'px';\r\n            document.getElementById(this.fatherId).appendChild(layerDiv);\r\n            this.createdDiv();\r\n        },\r\n        // 创建小的div来包含小的canvas\r\n        createdDiv() {\r\n            for (let i = 1; i <= this.rowNum * this.colNum; i++) {\r\n                let div = document.createElement('div');\r\n                div.setAttribute('id', 'smallDiv' + i);\r\n                div.setAttribute('style', 'float: left;');\r\n                div.style.width = this.smallDivWidth + 'px';\r\n                div.style.height = this.smallDivHigh + 'px';\r\n                document.getElementById('layerDiv').appendChild(div);\r\n            }\r\n            this.createdCanvas();\r\n        },\r\n        // 创建小的canvas来画水印\r\n        createdCanvas() {\r\n            for (let i = 1; i <= this.rowNum * this.colNum; i++) {\r\n                let canvas = document.createElement('canvas');\r\n                document.getElementById('smallDiv' + i).appendChild(canvas);\r\n                canvas.setAttribute('id', 'canvas' + i);\r\n                canvas.width = this.smallCanvasWidth;\r\n                canvas.height = this.smallCanvasHigh;\r\n                let ctx = canvas.getContext('2d');\r\n                ctx.beginPath();\r\n                ctx.rotate(this.angle * this.deg);\r\n                ctx.font = this.font;\r\n                ctx[this.lineType](this.txt, this.waterMarkSpace, this.waterMarkTop);\r\n                ctx[this.lineColorType] = this.fontColor;\r\n                ctx.closePath();\r\n                //  this.canvasToImage(canvas);\r\n            }\r\n        },\r\n        //  把canvas转化成base64格式的方法\r\n        canvasToImage(canvas) {\r\n            let image = new Image();\r\n            image.src = canvas.toDataURL('image/png');\r\n        }\r\n    }\r\n};\r\n</script>\r\n\n\n\n// WEBPACK FOOTER //\n// src/components/vueWaterMarkTools.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"layerDiv\"}})}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-52d83b0a\",\"hasScoped\":false,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/vueWaterMarkTools.vue\n// module id = null\n// module chunks = ","var normalizeComponent = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./vueWaterMarkTools.vue\"\nimport __vue_script__ from \"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./vueWaterMarkTools.vue\"\n/* template */\nimport __vue_template__ from \"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-52d83b0a\\\",\\\"hasScoped\\\":false,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./vueWaterMarkTools.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/vueWaterMarkTools.vue\n// module id = null\n// module chunks = ","import VueWaterMarkTools from '../components/vueWaterMarkTools.vue'\r\n\r\nconst vueWaterMarkTools = {\r\n  install: function (Vue) {\r\n    if (typeof window !== 'undefined' && window.Vue) {\r\n      Vue = window.Vue\r\n    }\r\n    Vue.component('vueWaterMarkTools', VueWaterMarkTools)\r\n  }\r\n}\r\n\r\nexport default vueWaterMarkTools;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/lib/index.js"],"sourceRoot":""}